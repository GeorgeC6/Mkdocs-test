# Lec 3

## IP 地址

没有子网掩码的 IP 地址是不完整的

### IPv4 地址的结构

32 个二进制位，用{==点分十进制==}表示

***e.g.***
大物实验选课系统：`10.203.16.55`

### 子网掩码

> 用于表明 IP 地址的哪部分是网络地址，哪部分是主机地址

"1": 网络部分，"0": 主机部分

***e.g.*** 

- IP 地址：`192.168.1.100`
- 子网掩码：`255.255.255.0`

前 24 位 `1` 对应网络号（网络ID），后 8 位 `0` 对应主机号（主机ID）


!!! tip ""
    子网掩码是IP地址的重要组成部分！

!!! note "计算主机数量"
    给定子网掩码和IP地址，计算主机数量：

    1. 计算 $2^{\text{主机部分的位数}}$
    2. 还要**减去2**
           - 一个是网络地址
           - 一个是广播地址

    - 网络地址：网络部分不动，主机部分全0
    - 广播地址：网络部分不动，主机部分全1

### 子网掩码的用处

主机发送数据包时，源主机会根据子网掩码判断目的主机是否在同一网段

### IP 地址分类

- A 类：一个Byte表示网络部分，三个Byte表示主机部分
    - 默认子网掩码：`255.0.0.0`
    - 一般用于大型组织，共有 $2^{24}-2$ 个主机
- B 类：两个Byte表示网络部分，两个Byte表示主机部分
    - 默认子网掩码：`255.255.0.0`
    - $2^{16}-2$ 个主机
- C 类：三个Byte表示网络部分，一个Byte表示主机部分
    - 默认子网掩码：`255.255.255.0`
    - $2^8-2$ 个主机

***e.g.***

- 清华：`166.111.*.*`（B类）
- 北大：`162.105.*.*`（B类）
- 浙大：`210.32.*.*`（C类[^1]）

[^1]: 加入较晚，真三本... ![](../../images/tieba/hehe.png)

### 公有和私有地址

2011年，IP地址用尽

延续 IPv4 的生命：**私有地址**，仅供组织内部使用，不能访问 Internet，沿用至今

浙大：A 类私有地址[^2] `10.*.*.*`

[^2]: 也算保留大型组织的角色，还是top3！ ![](../../images/tieba/heihei.png)

### 特殊用户或专用地址

- 环回地址
    - 用于测试网卡及TCP/IP协议安装是否正常
    - `127.0.0.1` 至 `127.255.255.254`
    - localhost: `127.0.0.1`
- 本地链路地址/自动私有 IP 编址（APIPA）
    - Windows 在无法获取 DHCP 服务器的情况下，自动分配的 IP 地址
- test-net

私有地址不能在 Internet 上路由，数据被ISP拒绝

## 网络地址转换

将私有地址转换为可路由的公有 Internet 地址：**网络地址转换**（NAT）

一般情况下，通过NAT，无线路由器将私有地址转换为公有地址，实现内网主机访问 Internet

!!! warning ""
    无线路由器的 LAN 口和 WAN 口的 IP 地址必须属于不同网络，即网络部分不同!

## 单播、广播、组播

### 单播地址

- 一对一通信

### 广播地址

- 发送广播时，数据包以{++主机部分全为1++}的形式发送

### 组播地址

## IPv6 地址

128位二进制，用{==冒号分隔的十六进制==}表示

表示方法：

- `x:x:x:x:x:x:x:x`
- 不区分大小写
- 字段中的前导0可以省略
    - 例：`09C0` 可以写成 `9C0`
- 连续的0段可以用`::`代替，但只能用一次
    - 例：`0:0:0:0:0:0:0:1` 可以写成 `::1`，此即 IPv6 的环回地址

### 前缀长度

- 用于表示网络地址的长度,相当于 IPv4 的子网掩码
- 格式：`IPv6 地址/前缀长度`

### 类型

- 单播（Unicast）
    - 用于唯一标识的接口
- 组播（Multicast）
- 任播（Anycast）

!!! warning ""
    IPv6 没有广播地址！

#### 单播地址

- 全局单播地址（Global Unicast Address, GUA）
    - 类似于 IPv4 的公有地址
    - 全局唯一性
    - Internet 可路由
- 本地链路地址（Link Local Address, LLA）
    - 用于同一链路/子网上的通信
    - 每个支持 IPv6 的网络接口都有一个 LLA
- 唯一本地地址（Unique Local Address, ULA）
    - 用于一个站点内的通信
    - IPv6 的专用/私有地址

## IPv4 和 IPv6 共存

- 双堆栈
- 隧道
    - 通过 IPv4 网络传输 IPv6 数据包，将 IPv6 数据包封装在 IPv4 数据包中
- 转换
    - NAT64

## *无线技术

### 无线电射频（RF）

ISM波段：800MHz, 2.4GHz, 5GHz等，限制较少

!!! question "为什么 WLAN 选择 2.4GHz 和 5GHz？"
    - 1947，微波炉商用，选用 2.45GHz
    - 1985，ITU规定ISM频段，FCC分配ISM
        - 工业 900MHz、科学 2.4GHz、医疗 5GHz
        - 从微波炉出发考虑
    - 1999，IEEE从上述ISM频段中选取 2.4GHz 和 5GHz 作为 WLAN 频段

---

## 实验讲解课件

### 集成路由器

- 无线AP
- 有线路由器
- 有线交换机
- 防火墙设备

### 无线客户端

### 无线网桥

### WLAN模式

- 基础设施模式（Infrastructure）
- 对等模式（Ad-hoc）
    - 个人热点

### 服务器标识集（SSID，Service Set Identifier）

- SSID 相当于 WLAN 的名称

### 通道（Channel）

避免冲突

### 配置接入点

### 配置无线客户端

---

## **<center>实验</center>**

!!! info "实验心得"
    路由器和AP的区别：路由器有 NAT 功能，交换机没有。所以，配置路由器比较简单，但是配置AP的时候，内网（`10.`开头）和外网（`192.`开头）不能同时访问。这个时候要在有线配置AP的时候，在 Windows 控制面板网络设置中的某个位置（忘了，好像是以太网卡的 IPv4 设置中的某个选项卡），把两个地址都添加上，这样就可以同时访问了。

    另外，有线配置完AP后，是要把AP插到讲台上的交换机上的，然后用电脑无线连接AP。现在回想起来，自己和组员都是非常的清澈而愚蠢...![](../../images/tieba/wuyu.png)